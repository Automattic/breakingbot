#!/bin/sh
set -e

echo "-----> Install app configs"

# Clone the deployment configs
git clone --depth 1 git@github.com:Automattic/breakingbot-deployments.git

# Remove all existing configs except the gifs and default priorities configs
find ./config -mindepth 1 ! -name 'gifs.ts' ! -name 'priorities.ts' ! -name 'types.ts' -exec rm -rf {} \;

# Copy over our new configs
cp -r ./breakingbot-deployments/config/* ./config

# Install the a8c WP.com reporter
cp ./breakingbot-deployments/lib/boundary/report-platforms/wpcom.ts ./lib/boundary/report-platforms/wpcom.ts

rm -rf ./breakingbot-deployments

echo "-----> Installed app config ($APP_ENV)"
